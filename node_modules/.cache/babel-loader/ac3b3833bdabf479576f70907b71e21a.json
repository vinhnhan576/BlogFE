{"ast":null,"code":"import _regeneratorRuntime from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useMemo}from'react';import{useParams}from'react-router-dom';import{getBlogBySlugAsync}from'../features/post/blogSlice';import Helmet from'../components/Helmet';import Banner from'../components/Banner';import{useDispatch,useSelector}from'react-redux';import PageNotFound from'./PageNotFound';import Comment from'../components/Comment';import alt from'../assets/image/blog/alt.jpg';import{createNewComment,getAllCommentsByBlogAsync}from'../features/comment/commentSlice';import{useState}from'react';import Reply from'../components/Reply';import{getBloggerByUserID}from'../features/user/bloggerSlice';import axios,{Axios}from'axios';import serverUrl from'../features/common/common';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Blog(){var params=useParams();var slug=params.slug;var dispatch=useDispatch();// const user = useSelector((state) => state.user);\nvar blogger=useSelector(function(state){return state.blogger;});var user=useSelector(function(state){return state.user;});var blogs=useSelector(function(state){return state.blog;});var comments=useSelector(function(state){return state.comment;});var blog=Array.isArray(blogs)?blogs===null||blogs===void 0?void 0:blogs.find(function(blog){return blog.slug===slug;}):blogs;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),commentUser=_useState2[0],setCommentUser=_useState2[1];function getBlog(){return _getBlog.apply(this,arguments);}function _getBlog(){_getBlog=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return dispatch(getBlogBySlugAsync(slug));case 2:_context3.next=4;return dispatch(getAllCommentsByBlogAsync(blog===null||blog===void 0?void 0:blog._id));case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _getBlog.apply(this,arguments);}useEffect(function(){getBlog();},[dispatch,slug,blog===null||blog===void 0?void 0:blog._id]);useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var commentUserID,user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:commentUserID=_toConsumableArray(new Set(comments.map(function(comment){return comment.userID;})));console.log(commentUserID);user=[];_context2.next=5;return Promise.all(commentUserID.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userID){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios(\"\".concat(serverUrl,\"api/user/get-user-by-id?userID=\").concat(userID)).then(function(response){console.log(response.data.result);user.push(response.data.result);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()));case 5:setCommentUser(user);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[comments]);console.log(commentUser);// console.log(comments);\nif(typeof blog==='object')// if (blog)\nreturn/*#__PURE__*/_jsxs(Helmet,{title:\"Blog\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"blog\",children:[blog.coverImg!==undefined?/*#__PURE__*/_jsx(Banner,{img:'data:image/jpg;base64,'+blog.coverImg.toString('base64'),alt:alt,quote:blog.quote}):/*#__PURE__*/_jsx(Banner,{img:alt,alt:alt,quote:blog.quote}),/*#__PURE__*/_jsx(\"div\",{className:\"blog__timestamp\",children:\"\".concat(blog.location===undefined?blog.location+' - ':'').concat(blog.date===undefined?'':blog.date.slice(0,10))}),/*#__PURE__*/_jsxs(\"div\",{className:\"blog__content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"blog__content__title\",children:blog.title}),/*#__PURE__*/_jsx(\"div\",{className:\"blog__content__body\",children:blog.content}),/*#__PURE__*/_jsx(\"div\",{className:\"blog__content__signature\",children:blog.signature})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-section\",children:[/*#__PURE__*/_jsx(Reply,{blogID:blog._id,userID:user._id,isHeadComment:true,parentID:\"\"}),comments.map(function(comment){return/*#__PURE__*/_jsx(Comment,{comment:comment,blogID:blog._id,userID:user._id,commentUser:commentUser,alias:blogger.alias,head:true,lastchild:false},comment._id);})]})]});}export default Blog;","map":{"version":3,"names":["React","useEffect","useMemo","useParams","getBlogBySlugAsync","Helmet","Banner","useDispatch","useSelector","PageNotFound","Comment","alt","createNewComment","getAllCommentsByBlogAsync","useState","Reply","getBloggerByUserID","axios","Axios","serverUrl","Blog","params","slug","dispatch","blogger","state","user","blogs","blog","comments","comment","Array","isArray","find","commentUser","setCommentUser","getBlog","_id","fetchData","commentUserID","Set","map","userID","console","log","Promise","all","then","response","data","result","push","coverImg","undefined","toString","quote","location","date","slice","title","content","signature","alias"],"sources":["D:/Code/HTML/blog/BlogProject/client/src/pages/Blog.jsx"],"sourcesContent":["import React, { useEffect, useMemo } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { getBlogBySlugAsync } from '../features/post/blogSlice';\r\nimport Helmet from '../components/Helmet';\r\nimport Banner from '../components/Banner';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport PageNotFound from './PageNotFound';\r\nimport Comment from '../components/Comment';\r\nimport alt from '../assets/image/blog/alt.jpg';\r\nimport {\r\n    createNewComment,\r\n    getAllCommentsByBlogAsync,\r\n} from '../features/comment/commentSlice';\r\nimport { useState } from 'react';\r\nimport Reply from '../components/Reply';\r\nimport { getBloggerByUserID } from '../features/user/bloggerSlice';\r\nimport axios, { Axios } from 'axios';\r\nimport serverUrl from '../features/common/common';\r\n\r\nfunction Blog() {\r\n    const params = useParams();\r\n    const slug = params.slug;\r\n    const dispatch = useDispatch();\r\n    // const user = useSelector((state) => state.user);\r\n    const blogger = useSelector((state) => state.blogger);\r\n    const user = useSelector((state) => state.user);\r\n    const blogs = useSelector((state) => state.blog);\r\n    const comments = useSelector((state) => state.comment);\r\n    const blog = Array.isArray(blogs)\r\n        ? blogs?.find((blog) => blog.slug === slug)\r\n        : blogs;\r\n\r\n    const [commentUser, setCommentUser] = useState([]);\r\n    async function getBlog() {\r\n        await dispatch(getBlogBySlugAsync(slug));\r\n        await dispatch(getAllCommentsByBlogAsync(blog?._id));\r\n    }\r\n\r\n    useEffect(() => {\r\n        getBlog();\r\n    }, [dispatch, slug, blog?._id]);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            const commentUserID = [\r\n                ...new Set(comments.map((comment) => comment.userID)),\r\n            ];\r\n            console.log(commentUserID);\r\n\r\n            var user = [];\r\n            await Promise.all(\r\n                commentUserID.map(async (userID) => {\r\n                    await axios(\r\n                        `${serverUrl}api/user/get-user-by-id?userID=${userID}`\r\n                    ).then((response) => {\r\n                        console.log(response.data.result);\r\n                        user.push(response.data.result);\r\n                    });\r\n                    // commentUser.push(result);\r\n                })\r\n            );\r\n            setCommentUser(user);\r\n        };\r\n        fetchData();\r\n    }, [comments]);\r\n\r\n    console.log(commentUser);\r\n\r\n    // console.log(comments);\r\n\r\n    if (typeof blog === 'object')\r\n        // if (blog)\r\n        return (\r\n            <Helmet title=\"Blog\">\r\n                <div className=\"blog\">\r\n                    {blog.coverImg !== undefined ? (\r\n                        <Banner\r\n                            img={\r\n                                'data:image/jpg;base64,' +\r\n                                blog.coverImg.toString('base64')\r\n                            }\r\n                            alt={alt}\r\n                            quote={blog.quote}\r\n                        />\r\n                    ) : (\r\n                        <Banner img={alt} alt={alt} quote={blog.quote} />\r\n                    )}\r\n                    <div className=\"blog__timestamp\">{`${\r\n                        blog.location === undefined ? blog.location + ' - ' : ''\r\n                    }${\r\n                        blog.date === undefined ? '' : blog.date.slice(0, 10)\r\n                    }`}</div>\r\n                    <div className=\"blog__content\">\r\n                        <div className=\"blog__content__title\">{blog.title}</div>\r\n                        <div className=\"blog__content__body\">\r\n                            {blog.content}\r\n                        </div>\r\n                        <div className=\"blog__content__signature\">\r\n                            {blog.signature}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"comment-section\">\r\n                    <Reply\r\n                        blogID={blog._id}\r\n                        userID={user._id}\r\n                        isHeadComment={true}\r\n                        parentID=\"\"\r\n                    />\r\n                    {comments.map((comment) => {\r\n                        return (\r\n                            <Comment\r\n                                comment={comment}\r\n                                key={comment._id}\r\n                                blogID={blog._id}\r\n                                userID={user._id}\r\n                                commentUser={commentUser}\r\n                                alias={blogger.alias}\r\n                                head={true}\r\n                                lastchild={false}\r\n                            />\r\n                        );\r\n                    })}\r\n                </div>\r\n            </Helmet>\r\n        );\r\n}\r\n\r\nexport default Blog;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}