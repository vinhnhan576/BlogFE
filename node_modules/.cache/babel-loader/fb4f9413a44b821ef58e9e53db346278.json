{"ast":null,"code":"import _regeneratorRuntime from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/Code/HTML/blog/BlogProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useDispatch}from'react-redux';import{authenticateUserAsync}from'../features/account/accountSlice';import{getUserByUsernameAsync}from'../features/user/userSlice';import{Link,useNavigate}from'react-router-dom';import loginImage01 from'../assets/image/login/login-image-01.png';import logo from'../assets/image/login/login-logo.png';import{unwrapResult}from'@reduxjs/toolkit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var dispatch=useDispatch();var navigate=useNavigate();var user=JSON.parse(localStorage.getItem('user'));if(user&&user.token){navigate('/'+user.account.alias+'/');}var initialUserState={username:'',password:''};var _useState=useState(initialUserState),_useState2=_slicedToArray(_useState,2),account=_useState2[0],setAccount=_useState2[1];var handleChange=function handleChange(input){return function(event){setAccount(_objectSpread(_objectSpread({},account),{},_defineProperty({},input,event.target.value)));};};var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var result,originalPromiseResult,alias;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();console.log('logging in...');_context.next=4;return dispatch(authenticateUserAsync({username:account.username,password:account.password}));case 4:_context.next=6;return dispatch(getUserByUsernameAsync({username:account.username}));case 6:result=_context.sent;originalPromiseResult=unwrapResult(result);alias=result.payload.tasks.result.alias;navigate(\"/\".concat(alias,\"/\"));if(originalPromiseResult.tasks.alias!==undefined)navigate(\"/\".concat(originalPromiseResult.tasks.alias,\"/\"));case 11:case\"end\":return _context.stop();}}},_callee);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"login__image\",children:/*#__PURE__*/_jsx(\"img\",{src:loginImage01,alt:\"\"})}),/*#__PURE__*/_jsxs(\"form\",{className:\"login__form\",onSubmit:handleLogin,children:[/*#__PURE__*/_jsx(\"div\",{className:\"login__logo\",children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login__form__item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"login__form__item__title\",children:\"t\\xE0i kho\\u1EA3n\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",id:\"username\",onChange:handleChange('username')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login__form__item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"login__form__item__title\",children:\"m\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",id:\"password\",onChange:handleChange('password')})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login__form__button login__form__login-button\",children:\"\\u0111\\u0103ng nh\\u1EADp\"}),/*#__PURE__*/_jsx(Link,{to:\"signup\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login__form__button\",children:\"\\u0111\\u0103ng k\\xFD\"})})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useDispatch","authenticateUserAsync","getUserByUsernameAsync","Link","useNavigate","loginImage01","logo","unwrapResult","Login","dispatch","navigate","user","JSON","parse","localStorage","getItem","token","account","alias","initialUserState","username","password","setAccount","handleChange","input","event","target","value","handleLogin","e","preventDefault","console","log","result","originalPromiseResult","payload","tasks","undefined"],"sources":["D:/Code/HTML/blog/BlogProject/client/src/pages/Login.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nimport { authenticateUserAsync } from '../features/account/accountSlice';\r\nimport { getUserByUsernameAsync } from '../features/user/userSlice';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\n\r\nimport loginImage01 from '../assets/image/login/login-image-01.png';\r\nimport logo from '../assets/image/login/login-logo.png';\r\nimport { unwrapResult } from '@reduxjs/toolkit';\r\n\r\nconst Login = () => {\r\n\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n\r\n    \r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n    if (user && user.token) {\r\n        navigate('/' + user.account.alias + '/');\r\n    }\r\n    const initialUserState = {\r\n        username: '',\r\n        password: '',\r\n    };\r\n\r\n    const [account, setAccount] = useState(initialUserState);\r\n\r\n    const handleChange = (input) => (event) => {\r\n        setAccount({ ...account, [input]: event.target.value });\r\n    };\r\n\r\n    const handleLogin = async (e) => {\r\n        e.preventDefault();\r\n        console.log('logging in...');\r\n        await dispatch(\r\n            authenticateUserAsync({\r\n                username: account.username,\r\n                password: account.password,\r\n            })\r\n        );\r\n        const result = await dispatch(\r\n            getUserByUsernameAsync({\r\n                username: account.username,\r\n            })\r\n        );\r\n        const originalPromiseResult = unwrapResult(result);\r\n        const alias = result.payload.tasks.result.alias;\t\r\n        navigate(`/${alias}/`);\r\n        if (originalPromiseResult.tasks.alias !== undefined)\r\n            navigate(`/${originalPromiseResult.tasks.alias}/`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"login\">\r\n            <div className=\"login__image\">\r\n                <img src={loginImage01} alt=\"\" />\r\n            </div>\r\n            <form className=\"login__form\" onSubmit={handleLogin}>\r\n                <div className=\"login__logo\">\r\n                    <img src={logo} alt=\"\" />\r\n                </div>\r\n                <div className=\"login__form__item\">\r\n                    <div className=\"login__form__item__title\">tài khoản</div>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"username\"\r\n                        id=\"username\"\r\n                        onChange={handleChange('username')}\r\n                    />\r\n                </div>\r\n                <div className=\"login__form__item\">\r\n                    <div className=\"login__form__item__title\">mật khẩu</div>\r\n                    <input\r\n                        type=\"password\"\r\n                        name=\"password\"\r\n                        id=\"password\"\r\n                        onChange={handleChange('password')}\r\n                    />\r\n                </div>\r\n                <button\r\n                    type=\"submit\"\r\n                    className=\"login__form__button login__form__login-button\"\r\n                >\r\n                    đăng nhập\r\n                </button>\r\n                <Link to=\"signup\">\r\n                    <button type=\"submit\" className=\"login__form__button\">\r\n                        đăng ký\r\n                    </button>\r\n                </Link>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"mnBAAA,MAAOA,MAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,WAAT,KAA4B,aAA5B,CAEA,OAASC,qBAAT,KAAsC,kCAAtC,CACA,OAASC,sBAAT,KAAuC,4BAAvC,CACA,OAASC,IAAT,CAAeC,WAAf,KAAkC,kBAAlC,CAEA,MAAOC,aAAP,KAAyB,0CAAzB,CACA,MAAOC,KAAP,KAAiB,sCAAjB,CACA,OAASC,YAAT,KAA6B,kBAA7B,C,wFAEA,GAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,CAEhB,GAAMC,SAAQ,CAAGT,WAAW,EAA5B,CACA,GAAMU,SAAQ,CAAGN,WAAW,EAA5B,CAGA,GAAMO,KAAI,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAb,CACA,GAAIJ,IAAI,EAAIA,IAAI,CAACK,KAAjB,CAAwB,CACpBN,QAAQ,CAAC,IAAMC,IAAI,CAACM,OAAL,CAAaC,KAAnB,CAA2B,GAA5B,CAAR,CACH,CACD,GAAMC,iBAAgB,CAAG,CACrBC,QAAQ,CAAE,EADW,CAErBC,QAAQ,CAAE,EAFW,CAAzB,CAKA,cAA8BtB,QAAQ,CAACoB,gBAAD,CAAtC,wCAAOF,OAAP,eAAgBK,UAAhB,eAEA,GAAMC,aAAY,CAAG,QAAfA,aAAe,CAACC,KAAD,QAAW,UAACC,KAAD,CAAW,CACvCH,UAAU,gCAAML,OAAN,wBAAgBO,KAAhB,CAAwBC,KAAK,CAACC,MAAN,CAAaC,KAArC,GAAV,CACH,CAFoB,EAArB,CAIA,GAAMC,YAAW,4FAAG,iBAAOC,CAAP,2JAChBA,CAAC,CAACC,cAAF,GACAC,OAAO,CAACC,GAAR,CAAY,eAAZ,EAFgB,sBAGVvB,SAAQ,CACVR,qBAAqB,CAAC,CAClBmB,QAAQ,CAAEH,OAAO,CAACG,QADA,CAElBC,QAAQ,CAAEJ,OAAO,CAACI,QAFA,CAAD,CADX,CAHE,8BASKZ,SAAQ,CACzBP,sBAAsB,CAAC,CACnBkB,QAAQ,CAAEH,OAAO,CAACG,QADC,CAAD,CADG,CATb,QASVa,MATU,eAcVC,qBAdU,CAcc3B,YAAY,CAAC0B,MAAD,CAd1B,CAeVf,KAfU,CAeFe,MAAM,CAACE,OAAP,CAAeC,KAAf,CAAqBH,MAArB,CAA4Bf,KAf1B,CAgBhBR,QAAQ,YAAKQ,KAAL,MAAR,CACA,GAAIgB,qBAAqB,CAACE,KAAtB,CAA4BlB,KAA5B,GAAsCmB,SAA1C,CACI3B,QAAQ,YAAKwB,qBAAqB,CAACE,KAAtB,CAA4BlB,KAAjC,MAAR,CAlBY,uDAAH,kBAAXU,YAAW,4CAAjB,CAqBA,mBACI,aAAK,SAAS,CAAC,OAAf,wBACI,YAAK,SAAS,CAAC,cAAf,uBACI,YAAK,GAAG,CAAEvB,YAAV,CAAwB,GAAG,CAAC,EAA5B,EADJ,EADJ,cAII,cAAM,SAAS,CAAC,aAAhB,CAA8B,QAAQ,CAAEuB,WAAxC,wBACI,YAAK,SAAS,CAAC,aAAf,uBACI,YAAK,GAAG,CAAEtB,IAAV,CAAgB,GAAG,CAAC,EAApB,EADJ,EADJ,cAII,aAAK,SAAS,CAAC,mBAAf,wBACI,YAAK,SAAS,CAAC,0BAAf,+BADJ,cAEI,cACI,IAAI,CAAC,MADT,CAEI,IAAI,CAAC,UAFT,CAGI,EAAE,CAAC,UAHP,CAII,QAAQ,CAAEiB,YAAY,CAAC,UAAD,CAJ1B,EAFJ,GAJJ,cAaI,aAAK,SAAS,CAAC,mBAAf,wBACI,YAAK,SAAS,CAAC,0BAAf,gCADJ,cAEI,cACI,IAAI,CAAC,UADT,CAEI,IAAI,CAAC,UAFT,CAGI,EAAE,CAAC,UAHP,CAII,QAAQ,CAAEA,YAAY,CAAC,UAAD,CAJ1B,EAFJ,GAbJ,cAsBI,eACI,IAAI,CAAC,QADT,CAEI,SAAS,CAAC,+CAFd,sCAtBJ,cA4BI,KAAC,IAAD,EAAM,EAAE,CAAC,QAAT,uBACI,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,qBAAhC,kCADJ,EA5BJ,GAJJ,GADJ,CAyCH,CAnFD,CAqFA,cAAef,MAAf"},"metadata":{},"sourceType":"module"}